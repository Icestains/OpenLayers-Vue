(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f48c38d"],{"55df":function(t,e,i){"use strict";i.r(e);var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"root",attrs:{id:"local"}},[i("div",{staticClass:"map",attrs:{id:"imageMap"}}),i("div",{staticClass:"controls"},[i("button",{staticClass:"btn btn-outline-primary",attrs:{type:"button"},on:{click:function(e){return t.markLocalImage(t.imap)}}},[t._v("标记中心")])])])},a=[],n=(i("4989"),i("5eee")),r=i("a2c7"),s=i("5dec"),c=i("1af9"),h=function(t){function e(e){var i=e||{};t.call(this,i),this.type=s["a"].IMAGE}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(c["a"]);h.prototype.getSource;var g=h,u=i("3e6b"),l=i("f5dd"),p=i("8778"),_=i("869f"),m=i("1e8d"),d=i("01d4"),f=i("0af5"),I=function(t){function e(e,i,o,a,n,r){t.call(this,e,i,o,_["a"].IDLE),this.src_=a,this.image_=new Image,null!==n&&(this.image_.crossOrigin=n),this.imageListenerKeys_=null,this.state=_["a"].IDLE,this.imageLoadFunction_=r}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=_["a"].ERROR,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=Object(f["A"])(this.extent)/this.image_.height),this.state=_["a"].LOADED,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state!=_["a"].IDLE&&this.state!=_["a"].ERROR||(this.state=_["a"].LOADING,this.changed(),this.imageListenerKeys_=[Object(m["b"])(this.image_,d["a"].ERROR,this.handleImageError_,this),Object(m["b"])(this.image_,d["a"].LOAD,this.handleImageLoad_,this)],this.imageLoadFunction_(this,this.src_))},e.prototype.setImage=function(t){this.image_=t},e.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(m["e"]),this.imageListenerKeys_=null},e}(p["a"]),E=I,O=i("0999"),j=i("256f"),b=i("1300"),y=i("a504"),v=i("9f5e"),L=i("cef7"),R=i("3c81"),x=i("b739"),w=function(t){function e(e,i,o,a,n,r){var s=e.getExtent(),c=i.getExtent(),h=c?Object(f["B"])(o,c):o,g=Object(f["x"])(h),u=Object(R["a"])(e,i,g,a),l=y["b"],p=new x["a"](e,i,h,s,u*l),m=p.calculateSourceExtent(),d=r(m,u,n),I=_["a"].LOADED;d&&(I=_["a"].IDLE);var E=d?d.getPixelRatio():1;t.call(this,o,a,E,I),this.targetProj_=i,this.maxSourceExtent_=s,this.triangulation_=p,this.targetResolution_=a,this.targetExtent_=o,this.sourceImage_=d,this.sourcePixelRatio_=E,this.canvas_=null,this.sourceListenerKey_=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.disposeInternal=function(){this.state==_["a"].LOADING&&this.unlistenSource_(),t.prototype.disposeInternal.call(this)},e.prototype.getImage=function(){return this.canvas_},e.prototype.getProjection=function(){return this.targetProj_},e.prototype.reproject_=function(){var t=this.sourceImage_.getState();if(t==_["a"].LOADED){var e=Object(f["E"])(this.targetExtent_)/this.targetResolution_,i=Object(f["A"])(this.targetExtent_)/this.targetResolution_;this.canvas_=Object(R["b"])(e,i,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=t,this.changed()},e.prototype.load=function(){if(this.state==_["a"].IDLE){this.state=_["a"].LOADING,this.changed();var t=this.sourceImage_.getState();t==_["a"].LOADED||t==_["a"].ERROR?this.reproject_():(this.sourceListenerKey_=Object(m["a"])(this.sourceImage_,d["a"].CHANGE,function(t){var e=this.sourceImage_.getState();e!=_["a"].LOADED&&e!=_["a"].ERROR||(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}},e.prototype.unlistenSource_=function(){Object(m["e"])(this.sourceListenerKey_),this.sourceListenerKey_=null},e}(p["a"]),A=w,D=i("ff80"),S={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"},G=function(t){function e(e,i){t.call(this,e),this.image=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(L["a"]),k=function(t){function e(e){t.call(this,{attributions:e.attributions,projection:e.projection,state:e.state}),this.resolutions_=void 0!==e.resolutions?e.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getResolutions=function(){return this.resolutions_},e.prototype.findNearestResolution=function(t){if(this.resolutions_){var e=Object(v["f"])(this.resolutions_,t,0);t=this.resolutions_[e]}return t},e.prototype.getImage=function(t,e,i,o){var a=this.getProjection();if(y["a"]&&a&&o&&!Object(j["c"])(a,o)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&Object(j["c"])(this.reprojectedImage_.getProjection(),o)&&this.reprojectedImage_.getResolution()==e&&Object(f["p"])(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new A(a,o,t,e,i,function(t,e,i){return this.getImageInternal(t,e,i,a)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return a&&(o=a),this.getImageInternal(t,e,i,o)},e.prototype.getImageInternal=function(t,e,i,o){return Object(b["b"])()},e.prototype.handleImageChange=function(t){var e=t.target;switch(e.getState()){case _["a"].LOADING:this.loading=!0,this.dispatchEvent(new G(S.IMAGELOADSTART,e));break;case _["a"].LOADED:this.loading=!1,this.dispatchEvent(new G(S.IMAGELOADEND,e));break;case _["a"].ERROR:this.loading=!1,this.dispatchEvent(new G(S.IMAGELOADERROR,e));break;default:}},e}(D["a"]);function C(t,e){t.getImage().src=e}var M=k,z=function(t){function e(e){var i=void 0!==e.crossOrigin?e.crossOrigin:null,o=void 0!==e.imageLoadFunction?e.imageLoadFunction:C;t.call(this,{attributions:e.attributions,projection:Object(j["d"])(e.projection)}),this.url_=e.url,this.imageExtent_=e.imageExtent,this.image_=new E(this.imageExtent_,void 0,1,this.url_,i,o),this.imageSize_=e.imageSize?e.imageSize:null,Object(m["a"])(this.image_,d["a"].CHANGE,this.handleImageChange,this)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getImageExtent=function(){return this.imageExtent_},e.prototype.getImageInternal=function(t,e,i,o){return Object(f["F"])(t,this.image_.getExtent())?this.image_:null},e.prototype.getUrl=function(){return this.url_},e.prototype.handleImageChange=function(e){if(this.image_.getState()==_["a"].LOADED){var i,o,a=this.image_.getExtent(),n=this.image_.getImage();this.imageSize_?(i=this.imageSize_[0],o=this.imageSize_[1]):(i=n.width,o=n.height);var r=Object(f["A"])(a)/o,s=Math.ceil(Object(f["E"])(a)/r);if(s!=i){var c=Object(O["a"])(s,o),h=c.canvas;c.drawImage(n,0,0,i,o,0,0,h.width,h.height),this.image_.setImage(h)}}t.prototype.handleImageChange.call(this,e)},e}(M),N=z,K=i("5831"),P=i("6c77"),F=i("6cbf"),T=i("f403"),H=i("4cdf"),J=i("e8b5"),Z=i.n(J),B=i("cf05"),U=i.n(B),V={name:"localImg",data:function(){return{map:null,view:null,imap:null,zoom:12,resolution:0,center:[0,0],extent:[0,0,0,0],moveStep:1e4}},mounted:function(){this.initLocalImage()},methods:{initLocalImage:function(){var t=[0,0,2732,2048],e=new l["a"]({code:"xkcd-image",units:"pixels",extent:t});this.imap=new n["a"]({target:"imageMap",layers:[new g({source:new N({url:Z.a,imageExtent:t})})],view:new r["a"]({extent:t,center:Object(f["x"])(t),projection:e,zoom:2,minZoom:1,maxZoom:5})})},markLocalImage:function(t){var e=t.getView().calculateExtent(t.getSize()),i=Object(f["x"])(e);window.console.log("extent:"+e),window.console.log("center:"+i);var o=new u["a"]({source:new K["a"]}),a=new H["a"]({geometry:new T["a"]([i[0],i[1]])});a.setStyle(new P["c"]({image:new F["a"]({src:U.a,anchor:[.5,1],scale:.2})})),o.getSource().addFeature(a),t.addLayer(o)}}},$=V,q=i("2877"),Q=Object(q["a"])($,o,a,!1,null,"1629801e",null);e["default"]=Q.exports},e8b5:function(t,e,i){t.exports=i.p+"img/backimage.01b9cda7.jpg"}}]);